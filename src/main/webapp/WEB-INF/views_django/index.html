{% extends "layout.html" %}

{% block content %}

<script type="text/javascript">
     function doFormSubmit() {
    	$('#oda-gear').show(); 
	 	$('#file_upload').uploadifyUpload();
 }
 
 $(document).ready(function() { 
 	
	 var processDisassembly = function(ret) { 
		$('#listing').html(ret.opcodeHtml);
		$('#rawBytes').html(ret.rawBytesHtml);
		$('#offset').html(ret.offsetHtml);
		$('#branchLines').html(ret.branchTargetHtml);
		
		$('#strings-content').html(ret.stringHtml);
		$('#sections-content').html(ret.sectionHtml);
        $('#hex-content').val(ret.hexDump);
		$('#modal-from-dom').modal('hide');
		$('#oda-gear').hide();  
	 };
	 
	 $('#login-form').popover({
		 html: true,
		 placement: 'below',
		 delayOut: '5000',
		 content: function() { 
			 return '<p>Do you already have an account on one of these sites? Click the logo to log in with it here:</p>'
					 +'<a href="openid?provider=google"><img src="/resources/images/openid_google.png"/></a> '
					 + '<a href="openid?provider=yahoo"><img src="/resources/images/openid_yahoo.png"/></a>'; } 
	 }); 
	 $('#login-form').popover('show');
	 setTimeout(function() {$('#login-form').popover('hide');},6000 ); 
	 $('.tabs').tabs();
	 $('#assembly-tab-item').trigger('click');
	 
	 $('#save-hex,#disassembleBtn').click(function() { 
		 $('#oda-gear').show(); 
		 $.ajax('/rest/disassemble/uploadHex',{
			 type: 'POST',
			 data: {
				 	hex : $('#hex-content').val(), 
				 	platformId : $('#platformSelect').val(), 
				 	endian : $('#endianSelect').val(),
				 	offset : $('#offsetInput').val()
			  }, 
			 success: function(data) { 
				// var ret = jQuery.parseJSON( data ); 	
				 processDisassembly(data); 
				 $('#assembly-tab-item').trigger('click');
			 }
		 }); 
		 return false; 
	 }); 
	 
  $('#file_upload').uploadify({
     	// Required Settings
		//langFile : '/jquery.uploadify-v3.0.0/uploadifyLang_en.js',
		swf : '/resources/scripts/lib/uploadify/uploadify.swf',
		checkExisting : '/rest/disassemble/checkExisting',
		uploader : '/rest/disassemble/uploadFile;jsessionid={{sessionId}}', 
		//debug : true, 
		auto : false,
		buttonImage : '',
		multi : false,
		fileTypeExts : '*',
		progressData    : 'all',		
		onUploadSuccess : function(file,data,response) {
			var ret = jQuery.parseJSON( data ); 	
			processDisassembly(ret); 
		}		  
     });    
 }); 
  </script>

      <div class="content">
        <!-- Main hero unit for a primary marketing message or call to action -->
        <div class="page-header row">
          
          <img src="/resources/images/oda.png" class="span2" style="width: 128px; height: 128px;"/>
          <img src="/resources/images/oda.gif" style="width: 128px; height: 128px; float:left; position: relative; left: -128px; margin-right:-128px; display:none;" id="oda-gear"/>
         
          <h1 class="span6">The Online Disassembler</h1>       
        </div>
        
<!--  
<div id="file_upload"></div>
	<center><button type="button" name="btSubmit" id="btSubmit" onclick="doFormSubmit()">Upload and Submit</button></center>
	-->
	
	<script type="text/javascript">
	 
	 	$(document).ready(function() {
	 		$('#file-upload-btn').click(function() { 
	 			$('#modal-from-dom').modal('show');
	 		}); 
	 	}); 
	</script>
	<!-- <div class="topbar-wrapper">
            <div data-dropdown="dropdown" class="topbar" id="topbar-example">
              <div class="topbar-inner">
                <div class="container">    
             	  <ul class="nav">
                    <li class="menu">
                      <a class="menu" href="#">File</a>
                      <ul class="menu-dropdown">
                        <li><a href="#" id="file-upload-btn">Upload</a></li>                       
                        <li class="divider"></li>
                        <li><a href="#">Another link</a></li>
                      </ul>
                    </li>
                    <li class="menu">
                      <a class="menu" href="#">Dropdown 2</a>
                      <ul class="menu-dropdown">
                        <li><a href="#">Secondary link</a></li>
                        <li><a href="#">Something else here</a></li>
                        <li class="divider"></li>
                        <li><a href="#">Another link</a></li>
                      </ul>
                    </li>
                  </ul>
                  <ul>
                    <li><a href="#">Link</a></li>
                    <li><a href="#">Link</a></li>
                  </ul>
                  <form action="">
                    <input type="text" placeholder="Search">
                  </form>
                  
                </div>
              </div>
            </div>
          </div> -->
	
          <ul class="tabs" data-tabs="tabs">
            <li class="active"><a href="#hex">Hex</a></li>
            <li><a href="#assembly" id="assembly-tab-item">Assembly</a></li>

            <li><a href="#strings">Strings</a></li>
            <li><a href="#sections">Sections</a></li>
            <!--  <li class="dropdown" data-dropdown="dropdown">
              <a href="#" class="dropdown-toggle">Dropdown</a>
              <ul class="dropdown-menu">
                <li><a href="#fat">@fat</a></li>
                <li><a href="#mdo">@mdo</a></li>

              </ul>
            </li>-->
          </ul>
          <div id="my-tab-content" class="tab-content">
            <div class="active tab-pane" id="hex">
            	<form class="well">
            		 <input class="btn primary" type="submit" value="Save" id="save-hex">
            	</form>
            		<textarea style="width:100%; height:400px;"  id="hex-content">
            		Raw denim you probably haven't heard of them jean shorts Austin.
            		</textarea>
              
            </div>
            <div class="tab-pane" id="assembly">
            	<form class="well">
            		<div class="row">
            		<div class="input span3">
            		 		<button data-controls-modal="modal-from-dom" data-backdrop="true" data-keyboard="true" class="btn danger">Upload File</button> 
            		</div>
                      		<label for="platformSelect">Platform</label>
            		<div class="input span2">
		              <select id="platformSelect" name="normalSelect" class="span2">
		                <option>X86</option>
		                <option>MIPS</option>
		                <option>ARM</option>
		                <option>PPC</option>		                
		              </select>
		            </div>
		            <label for="endianSelect">Endian</label>
            		<div class="input span2">
		              <select id="endianSelect" name="normalSelect" class="span2">
		                <option>LITTLE</option>
		                <option>BIG</option>
		                <option>DEFAULT</option>
		              </select>
		            </div>
		            <label for="offsetInput">Offset</label>
		            <input id="offsetInput" class="span2" type="text" name="offset" value="0x0"/>
		            <input class="btn primary pull-right" type="submit" id="disassembleBtn" value="Disassemble">
<!-- 		            <div class=""						 -->
		            </div>
            	</form>
				<div class="tabbed-scroll">
                    <div id="branchLines" style="width:100px; text-align:right; float:left; font-family:'Courier'; font-size: medium; color:#093C83"></div>
					<div id="offset" style="width:120px; float:left;"></div>
					<div id="rawBytes" style="width:80px; float:left;"></div>
					<div id="listing" style="width:600px; padding-left:300px;"></div>
				</div>            
            </div>
            <div class="tab-pane" id="strings">
            	<div class="tabbed-scroll" id="strings-content">
              		<p>Banksy do proident, brooklyn photo booth delectus sunt artisan sed organic exercitation eiusmod four loko. Quis tattooed iphone esse aliqua. Master cleanse vero fixie mcsweeney's. Ethical portland aute, irony food truck pitchfork lomo eu anim. Aesthetic blog DIY, ethical beard leggings tofu consequat whatever cardigan nostrud. Helvetica you probably haven't heard of them carles, marfa veniam occaecat lomo before they sold out in shoreditch scenester sustainable thundercats. Consectetur tofu craft beer, mollit brunch fap echo park pitchfork mustache dolor.</p>
              	</div>
            </div>
            <div class="tab-pane" id="sections">
            	<div class="tabbed-scroll" id="sections-content">
              		<p>Sunt qui biodiesel mollit officia, fanny pack put a bird on it thundercats seitan squid ad wolf bicycle rights blog. Et aute readymade farm-to-table carles 8-bit, nesciunt nulla etsy adipisicing organic ea. Master cleanse mollit high life, next level Austin nesciunt american apparel twee mustache adipisicing reprehenderit hoodie portland irony. Aliqua tofu quinoa +1 commodo eiusmod. High life williamsburg cupidatat twee homo leggings. Four loko vinyl DIY consectetur nisi, marfa retro keffiyeh vegan. Fanny pack viral retro consectetur gentrify fap.</p>
				</div>
            </div>           
          </div>

      
      </div>  
      
      
      <div id="modal-from-dom" class="modal hide fade">
            <div class="modal-header">
              <a href="#" class="close">&times;</a>
              <h3>File Upload</h3>
            </div>
            <div class="modal-body">
            	<div>
            		<div id="file_upload"></div>
					
	
            		<!--  <img src="/resources/images/upload.png"/>
            		<form style="width:450px; float: right;">
            			<input id="fileInput" class="input-file" type="file" name="fileInput" style="width:375px;">
            		</form>-->
            	</div>
            	{% include 'terms.html' %}
            </div>
            <div class="modal-footer">
              <a href="#" class="btn primary" onclick="doFormSubmit()">Submit</a>
              <a href="#" class="btn secondary">Cancel</a>
            </div>
          </div>
      
        {% endblock %}
        

